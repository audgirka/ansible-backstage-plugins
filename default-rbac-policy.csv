# Grant catalog permissions (dot notation - for named permissions)
p, role:default/aap-admins, catalog.entity.create, create, allow
p, role:default/aap-admins, catalog.entity.read, read, allow
p, role:default/aap-admins, catalog.entity.update, update, allow
p, role:default/aap-admins, catalog.entity.delete, delete, allow
# Grant catalog location permissions (for catalog-import)
p, role:default/aap-admins, catalog.location.create, create, allow
p, role:default/aap-admins, catalog.location.read, read, allow
p, role:default/aap-admins, catalog.location.update, update, allow
p, role:default/aap-admins, catalog.location.delete, delete, allow
# Grant permission to execute/launch any scaffolder template
p, role:default/aap-admins, scaffolder.template.parameter.read, read, allow
p, role:default/aap-admins, scaffolder.template.step.read, read, allow
p, role:default/aap-admins, scaffolder.action.execute, use, allow
p, role:default/aap-admins, scaffolder.task.create, create, allow
p, role:default/aap-admins, scaffolder.task.read, read, allow
p, role:default/aap-admins, scaffolder.task.cancel, use, allow
# Grant permission to read, delete, use, create, and update permissions
p, role:default/aap-admins, permission.create, create, allow
p, role:default/aap-admins, permission.read, read, allow
p, role:default/aap-admins, permission.update, update, allow
p, role:default/aap-admins, permission.delete, delete, allow
p, role:default/aap-admins, permission.use, use, allow
# Grant RBAC policy management permissions (dot notation - for named permission)
p, role:default/aap-admins, policy.entity, create, allow
p, role:default/aap-admins, policy.entity, read, allow
p, role:default/aap-admins, policy.entity, update, allow
p, role:default/aap-admins, policy.entity, delete, allow
# Grant named permission for policy.entity.create (Option B - bypass transformation)
p, role:default/aap-admins, policy.entity.create, create, allow
# Assign the 'aap-admins' role to all AAP admins users
g, group:default/aap-admins, role:default/aap-admins

p, role:default/portal-users, catalog-entity, read, allow
p, role:default/portal-users, scaffolder.template.parameter.read, read, allow
p, role:default/portal-users, scaffolder.template.step.read, read, allow
p, role:default/portal-users, scaffolder.action.execute, use, allow
p, role:default/portal-users, scaffolder.task.create, create, allow
p, role:default/portal-users, scaffolder.task.read, read, allow
p, role:default/portal-users, scaffolder.task.cancel, use, allow

g, group:default/portal-users, role:default/portal-users
