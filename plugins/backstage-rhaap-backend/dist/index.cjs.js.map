{"version":3,"file":"index.cjs.js","sources":["../src/service/constant.ts","../src/service/ansibleRHAAPService.ts","../src/service/router.ts","../src/plugin.ts"],"sourcesContent":["/*\n * Copyright 2024 The Ansible plugin Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * This is the default scheduler rule.\n * frequency supports hours, minutes, seconds and can customize as required\n */\nexport const DEFAULT_SCHEDULE = {\n  frequency: { hours: 24 },\n  timeout: { minutes: 1 },\n};\n\nexport const VALID_LICENSE_TYPES = ['enterprise', 'developer', 'trial'];\n","/*\n * Copyright 2024 The Ansible plugin Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Config } from '@backstage/config';\nimport fetch from 'node-fetch';\nimport https from 'https';\n\nimport { DEFAULT_SCHEDULE, VALID_LICENSE_TYPES } from './constant';\nimport {\n  LoggerService,\n  readSchedulerServiceTaskScheduleDefinitionFromConfig,\n  SchedulerService,\n  SchedulerServiceTaskRunner,\n  SchedulerServiceTaskScheduleDefinition,\n} from '@backstage/backend-plugin-api';\n\nexport interface AAPSubscriptionCheck {\n  status: number;\n  isValid: boolean;\n  isCompliant: boolean;\n}\n\nclass AAPSubscriptionCheckError extends Error {\n  public status: number | null = null;\n  public message: string = '';\n\n  constructor(status: number, message: string) {\n    super();\n    this.status = status;\n    this.message = message;\n  }\n}\n\nexport class RHAAPService {\n  private hasValidSubscription: boolean = false;\n  private isAAPCompliant: boolean = false;\n  private statusCode: number = 500;\n  private readonly scheduleFn: () => Promise<void> = async () => {};\n  private static _instance: RHAAPService;\n  private config!: Config;\n  private logger!: LoggerService;\n\n  private constructor(\n    config: Config,\n    logger: LoggerService,\n    scheduler?: SchedulerService,\n  ) {\n    if (RHAAPService._instance) return RHAAPService._instance;\n\n    this.config = config;\n    this.logger = logger;\n\n    this.logger.info(`[backstage-rhaap-backend] Setting up the scheduler`);\n\n    let schedule: SchedulerServiceTaskScheduleDefinition = DEFAULT_SCHEDULE;\n    if (this.config.has('ansible.rhaap.schedule')) {\n      schedule = readSchedulerServiceTaskScheduleDefinitionFromConfig(\n        this.config.getConfig('ansible.rhaap.schedule'),\n      );\n    }\n\n    if (scheduler) {\n      const taskRunner = scheduler.createScheduledTaskRunner(schedule);\n      this.scheduleFn = this.createFn(taskRunner);\n      const clearSubscriptionCheckTimeout = setTimeout(async () => {\n        this.scheduleFn();\n        await this.checkSubscription();\n        clearTimeout(clearSubscriptionCheckTimeout);\n      }, 500);\n    }\n    RHAAPService._instance = this;\n  }\n\n  static getInstance(\n    config: Config,\n    logger: LoggerService,\n    scheduler?: SchedulerService,\n  ): RHAAPService {\n    return new RHAAPService(config, logger, scheduler);\n  }\n\n  getSubscriptionStatus(): AAPSubscriptionCheck {\n    return {\n      status: this.statusCode,\n      isValid: this.hasValidSubscription,\n      isCompliant: this.isAAPCompliant,\n    };\n  }\n\n  private createFn(taskRunner: SchedulerServiceTaskRunner) {\n    return async () =>\n      taskRunner.run({\n        id: 'backstage-rhaap-subscription-check',\n        fn: () => this.checkSubscription(),\n      });\n  }\n\n  private async isAAP25Instance(\n    baseUrl: string,\n    reqHeaders: fetch.RequestInit,\n  ) {\n    try {\n      // Send request to AAP\n      this.logger.info(\n        `[backstage-rhaap-backend] Pinging api gateway at ${baseUrl}/api/gateway/v1/ping/`,\n      );\n      const res = await fetch(`${baseUrl}/api/gateway/v1/ping/`, reqHeaders);\n      if (!res.ok) {\n        return false;\n      }\n      return true;\n    } catch (error) {\n      this.logger.error(\n        `[backstage-rhaap-backend] error: ${error} for ${baseUrl}/api/gateway/v1/ping/`,\n      );\n      return false;\n    }\n  }\n\n  private async checkSubscription() {\n    let baseUrl;\n    try {\n      const ansibleConfig = this.config.getConfig('ansible');\n      const rhaapConfig = ansibleConfig.getConfig('rhaap');\n      baseUrl = rhaapConfig.getString('baseUrl');\n      const token = rhaapConfig.getString('token');\n      const checkSSL = rhaapConfig.getBoolean('checkSSL') ?? true;\n      const agent = new https.Agent({\n        rejectUnauthorized: checkSSL,\n      });\n      const reqHeaders = {\n        headers: { Authorization: `Bearer ${token}` },\n        agent,\n      };\n\n      // check if AAP >=2.5 instance\n      let aapResponse: fetch.Response;\n      const isAAP25 = await this.isAAP25Instance(baseUrl, reqHeaders);\n      if (isAAP25) {\n        // Send request to AAP\n        this.logger.info(\n          `[backstage-rhaap-backend] Checking AAP subscription at ${baseUrl}/api/controller/v2/config/`,\n        );\n\n        // subscription check for AAP >=2.5\n        aapResponse = await fetch(\n          `${baseUrl}/api/controller/v2/config`,\n          reqHeaders,\n        );\n      } else {\n        // Send request to AAP\n        this.logger.info(\n          `[backstage-rhaap-backend] Checking AAP subscription at ${baseUrl}/api/v2/config/`,\n        );\n        // subscription check for AAP <2.5\n        aapResponse = await fetch(`${baseUrl}/api/v2/config`, reqHeaders);\n      }\n\n      const data = await aapResponse.json();\n      if (!aapResponse.ok) {\n        // make the promise be rejected if we didn't get a 2xx response\n        throw new AAPSubscriptionCheckError(aapResponse.status, data.detail);\n      } else {\n        this.statusCode = aapResponse.status;\n        this.hasValidSubscription = VALID_LICENSE_TYPES.includes(\n          data?.license_info?.license_type,\n        );\n        this.isAAPCompliant = data?.license_info?.compliant ?? false;\n      }\n    } catch (error: any) {\n      this.logger.error(\n        `[backstage-rhaap-backend] AAP subscription Check failed for ${baseUrl}/api/v2/config/`,\n      );\n      if (error instanceof AAPSubscriptionCheckError) {\n        this.statusCode = error.status ?? 404;\n      } else if (error.code === 'CERT_HAS_EXPIRED') {\n        this.statusCode = 495;\n      } else if (error.code === 'ECONNREFUSED' || error.code === 'ENOTFOUND') {\n        this.statusCode = 404;\n      } else {\n        this.statusCode =\n          Number.isInteger(error.code) && error.code >= 100 && error.code < 600\n            ? error.code\n            : 500;\n      }\n      this.logger.error(\n        `[backstage-rhaap-backend] Error: ${this.statusCode}: ${error.message}`,\n      );\n      this.hasValidSubscription = false;\n      this.isAAPCompliant = false;\n    }\n  }\n}\n","/*\n * Copyright 2024 The Ansible plugin Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport express from 'express';\nimport Router from 'express-promise-router';\n\nimport { MiddlewareFactory } from '@backstage/backend-defaults/rootHttpRouter';\nimport { Config } from '@backstage/config';\nimport { LoggerService, SchedulerService } from '@backstage/backend-plugin-api';\n\nimport { RHAAPService } from './ansibleRHAAPService';\n\nexport interface RouterOptions {\n  logger: LoggerService;\n  config: Config;\n  scheduler?: SchedulerService;\n}\n\nexport async function createRouter(\n  options: RouterOptions,\n): Promise<express.Router> {\n  const { logger, config, scheduler } = options;\n  const middleware = MiddlewareFactory.create({ config, logger });\n  const instance = RHAAPService.getInstance(config, logger, scheduler);\n\n  const router = Router();\n  router.use(middleware.helmet());\n  router.use(express.json());\n  router.use(middleware.error());\n\n  router.get('/health', (_, response) => {\n    logger.info('PONG!');\n    response.json({ status: 'ok' });\n  });\n\n  router.get('/aap/subscription', async (_, response) => {\n    // Return the subscription status\n    const res = instance.getSubscriptionStatus();\n    response.status(res.status).json(res);\n  });\n\n  return router;\n}\n","/*\n * Copyright 2024 The Ansible plugin Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  coreServices,\n  createBackendPlugin,\n} from '@backstage/backend-plugin-api';\nimport { createRouter } from './service/router';\n\n/**\n * Backstage Anisble backend plugin\n *\n * @public\n */\nexport const backstageRHAAPPlugin = createBackendPlugin({\n  pluginId: 'backstage-rhaap',\n  register(env) {\n    env.registerInit({\n      deps: {\n        config: coreServices.rootConfig,\n        logger: coreServices.logger,\n        httpRouter: coreServices.httpRouter,\n        scheduler: coreServices.scheduler,\n      },\n      async init({ config, logger, httpRouter, scheduler }) {\n        httpRouter.use(\n          await createRouter({\n            config,\n            logger,\n            scheduler,\n          }),\n        );\n      },\n    });\n  },\n});\n"],"names":["readSchedulerServiceTaskScheduleDefinitionFromConfig","fetch","https","MiddlewareFactory","Router","express","createBackendPlugin","coreServices"],"mappings":"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"}